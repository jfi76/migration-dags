<ShowPlanXML xmlns="http://schemas.microsoft.com/sqlserver/2004/07/showplan" Version="1.564" Build="16.0.1000.6"><BatchSequence><Batch><Statements><StmtSimple StatementText="exec get_prev_step_id  &apos;E7FAB167-C47A-4865-A8AE-429FA778414C&apos;, &apos;E7FAB167-C47A-4865-A8AE-429FA778414C&apos;" StatementId="1" StatementCompId="1" StatementType="EXECUTE PROC" RetrievedFromCache="false"><StoredProc ProcName="get_prev_step_id"><Statements><StmtSimple StatementText="&#xd;&#xa;create procedure [dbo].[get_prev_step_id] &#xd;&#xa;@current_step_id uniqueidentifier,&#xd;&#xa;@prev_step_id uniqueidentifier OUTPUT&#xd;&#xa;&#xd;&#xa;as &#xd;&#xa;&#xd;&#xa;declare @t_test_id uniqueidentifier&#xd;&#xa;declare @step_order int&#xd;&#xa;declare @prev_step_order int&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;select @t_test_id = t_test_id, @step_order=step_order&#xd;&#xa;from t_test_step &#xd;&#xa;where t_test_step_id = @current_step_id" StatementId="2" StatementCompId="3" StatementType="SELECT" RetrievedFromCache="false" StatementSubTreeCost="0.0032831" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="TRIVIAL" QueryHash="0x54BE77C0607C07D8" QueryPlanHash="0xDF8BDEE1E834C377" CardinalityEstimationModelVersion="70"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan CachedPlanSize="16" CompileTime="1" CompileCPU="1" CompileMemory="192"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="311472" EstimatedPagesCached="77868" EstimatedAvailableDegreeOfParallelism="2" MaxCompileMemory="654432"></OptimizerHardwareDependentProperties><RelOp NodeId="0" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="27" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="940" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_ID"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_ID"></ColumnReference></DefinedValue></DefinedValues><Object Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Index="[PK_T_TEST_STEP]" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_STEP_ID"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[@current_step_id]"><Identifier><ColumnReference Column="@current_step_id"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><ParameterList><ColumnReference Column="@current_step_id" ParameterDataType="uniqueidentifier" ParameterCompiledValue="{guid&apos;E7FAB167-C47A-4865-A8AE-429FA778414C&apos;}"></ColumnReference></ParameterList></QueryPlan></StmtSimple><StmtSimple StatementText="&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;select @prev_step_order=max(step_order)&#xd;&#xa;from t_test_step&#xd;&#xa;where t_test_id=@t_test_id and step_order&lt;@step_order" StatementId="3" StatementCompId="4" StatementType="SELECT" RetrievedFromCache="false" StatementSubTreeCost="0.00334737" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0xBA15A90BE2663B07" QueryPlanHash="0xF0BCC04C21E01D13" StatementOptmEarlyAbortReason="GoodEnoughPlanFound" CardinalityEstimationModelVersion="70"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan CachedPlanSize="24" CompileTime="4" CompileCPU="4" CompileMemory="304"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="311472" EstimatedPagesCached="77868" EstimatedAvailableDegreeOfParallelism="2" MaxCompileMemory="654432"></OptimizerHardwareDependentProperties><RelOp NodeId="0" PhysicalOp="Stream Aggregate" LogicalOp="Aggregate" EstimateRows="1" EstimateIO="0" EstimateCPU="1.1e-06" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00334737" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1002"></ColumnReference></OutputList><StreamAggregate><DefinedValues><DefinedValue><ColumnReference Column="Expr1002"></ColumnReference><ScalarOperator ScalarString="MAX([PSYCHOLOGY_TEST_1].[dbo].[T_TEST_STEP].[STEP_ORDER])"><Aggregate Distinct="0" AggType="MAX"><ScalarOperator><Identifier><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="1" PhysicalOp="Top" LogicalOp="Top" EstimateRows="1" EstimateIO="0" EstimateCPU="1e-07" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00334627" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference></OutputList><Top RowCount="0" IsPercent="0" WithTies="0"><TopExpression><ScalarOperator ScalarString="(1)"><Const ConstValue="(1)"></Const></ScalarOperator></TopExpression><RelOp NodeId="2" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="1" EstimateRowsWithoutRowGoal="27.825" EstimatedRowsRead="282" EstimateIO="0.00460648" EstimateCPU="0.0004672" AvgRowSize="27" EstimatedTotalSubtreeCost="0.00334131" TableCardinality="940" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_ID"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="BACKWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_ID"></ColumnReference></DefinedValue></DefinedValues><Object Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Index="[IX_T_TEST_STEP_1]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><EndRange ScanType="LT"><RangeColumns><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[@step_order]"><Identifier><ColumnReference Column="@step_order"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></EndRange></SeekKeys></SeekPredicateNew></SeekPredicates><Predicate><ScalarOperator ScalarString="[PSYCHOLOGY_TEST_1].[dbo].[T_TEST_STEP].[T_TEST_ID]=[@t_test_id]"><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_ID"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Column="@t_test_id"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></Predicate></IndexScan></RelOp></Top></RelOp></StreamAggregate></RelOp></QueryPlan></StmtSimple><StmtCond StatementText="&#xd;&#xa;&#xd;&#xa;if (@prev_step_order is not null) and (@prev_step_order&lt;@step_order)" StatementId="4" StatementCompId="5" StatementType="COND" RetrievedFromCache="false"><Condition></Condition><Then><Statements><StmtSimple StatementText="&#xd;&#xa;begin&#xd;&#xa;  select @prev_step_id=t_test_step_id&#xd;&#xa;  from t_test_step&#xd;&#xa;  where t_test_id=@t_test_id and step_order=@prev_step_order" StatementId="5" StatementCompId="6" StatementType="SELECT" RetrievedFromCache="false" StatementSubTreeCost="0.0032831" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="TRIVIAL" QueryHash="0xB0188EF8F1F36495" QueryPlanHash="0xA4D1017AE79A8837" CardinalityEstimationModelVersion="70"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan CachedPlanSize="16" CompileTime="1" CompileCPU="1" CompileMemory="192"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="311472" EstimatedPagesCached="77868" EstimatedAvailableDegreeOfParallelism="2" MaxCompileMemory="654432"></OptimizerHardwareDependentProperties><RelOp NodeId="0" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="23" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="940" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_STEP_ID"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_STEP_ID"></ColumnReference></DefinedValue></DefinedValues><Object Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Index="[IX_T_TEST_STEP_1]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="STEP_ORDER"></ColumnReference><ColumnReference Database="[PSYCHOLOGY_TEST_1]" Schema="[dbo]" Table="[T_TEST_STEP]" Column="T_TEST_ID"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[@prev_step_order]"><Identifier><ColumnReference Column="@prev_step_order"></ColumnReference></Identifier></ScalarOperator><ScalarOperator ScalarString="[@t_test_id]"><Identifier><ColumnReference Column="@t_test_id"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><ParameterList><ColumnReference Column="@prev_step_id" ParameterDataType="uniqueidentifier" ParameterCompiledValue="{guid&apos;E7FAB167-C47A-4865-A8AE-429FA778414C&apos;}"></ColumnReference></ParameterList></QueryPlan></StmtSimple></Statements></Then><Else><Statements><StmtSimple StatementText="&#xd;&#xa;&#xd;&#xa;end&#xd;&#xa;else &#xd;&#xa;set @prev_step_id = null &#xd;&#xa;&#xd;&#xa;&#xd;&#xa;" StatementId="6" StatementCompId="9" StatementType="ASSIGN" RetrievedFromCache="false"></StmtSimple></Statements></Else></StmtCond></Statements></StoredProc></StmtSimple></Statements></Batch></BatchSequence></ShowPlanXML>