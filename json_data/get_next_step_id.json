{"ShowPlanXML": {"@xmlns": "http://schemas.microsoft.com/sqlserver/2004/07/showplan", "@Version": "1.564", "@Build": "16.0.1000.6", "BatchSequence": {"Batch": {"Statements": {"StmtSimple": {"@StatementText": "exec get_next_step_id  'E7FAB167-C47A-4865-A8AE-429FA778414C', 'E7FAB167-C47A-4865-A8AE-429FA778414C'", "@StatementId": "1", "@StatementCompId": "1", "@StatementType": "EXECUTE PROC", "@RetrievedFromCache": "false", "StoredProc": {"@ProcName": "get_next_step_id", "Statements": {"StmtSimple": [{"@StatementText": "CREATE procedure get_next_step_id \r\n@current_step_id uniqueidentifier,\r\n@next_step_id uniqueidentifier OUTPUT\r\n\r\nas \r\n\r\ndeclare @t_test_id uniqueidentifier\r\ndeclare @step_order int\r\ndeclare @next_step_order int\r\n\r\n\r\n\r\nselect @t_test_id = t_test_id, @step_order=step_order\r\nfrom t_test_step \r\nwhere t_test_step_id = @current_step_id", "@StatementId": "2", "@StatementCompId": "3", "@StatementType": "SELECT", "@RetrievedFromCache": "false", "@StatementSubTreeCost": "0.0032831", "@StatementEstRows": "1", "@SecurityPolicyApplied": "false", "@StatementOptmLevel": "TRIVIAL", "@QueryHash": "0x54BE77C0607C07D8", "@QueryPlanHash": "0xDF8BDEE1E834C377", "@CardinalityEstimationModelVersion": "70", "StatementSetOptions": {"@QUOTED_IDENTIFIER": "true", "@ARITHABORT": "true", "@CONCAT_NULL_YIELDS_NULL": "true", "@ANSI_NULLS": "true", "@ANSI_PADDING": "true", "@ANSI_WARNINGS": "true", "@NUMERIC_ROUNDABORT": "false"}, "QueryPlan": {"@CachedPlanSize": "16", "@CompileTime": "0", "@CompileCPU": "0", "@CompileMemory": "192", "MemoryGrantInfo": {"@SerialRequiredMemory": "0", "@SerialDesiredMemory": "0", "@GrantedMemory": "0", "@MaxUsedMemory": "0"}, "OptimizerHardwareDependentProperties": {"@EstimatedAvailableMemoryGrant": "311472", "@EstimatedPagesCached": "77868", "@EstimatedAvailableDegreeOfParallelism": "2", "@MaxCompileMemory": "853880"}, "RelOp": {"@NodeId": "0", "@PhysicalOp": "Clustered Index Seek", "@LogicalOp": "Clustered Index Seek", "@EstimateRows": "1", "@EstimatedRowsRead": "1", "@EstimateIO": "0.003125", "@EstimateCPU": "0.0001581", "@AvgRowSize": "27", "@EstimatedTotalSubtreeCost": "0.0032831", "@TableCardinality": "940", "@Parallel": "0", "@EstimateRebinds": "0", "@EstimateRewinds": "0", "@EstimatedExecutionMode": "Row", "OutputList": {"ColumnReference": [{"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}, {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_ID"}]}, "IndexScan": {"@Ordered": "1", "@ScanDirection": "FORWARD", "@ForcedIndex": "0", "@ForceSeek": "0", "@ForceScan": "0", "@NoExpandHint": "0", "@Storage": "RowStore", "DefinedValues": {"DefinedValue": [{"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}}, {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_ID"}}]}, "Object": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Index": "[PK_T_TEST_STEP]", "@IndexKind": "Clustered", "@Storage": "RowStore"}, "SeekPredicates": {"SeekPredicateNew": {"SeekKeys": {"Prefix": {"@ScanType": "EQ", "RangeColumns": {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_STEP_ID"}}, "RangeExpressions": {"ScalarOperator": {"@ScalarString": "[@current_step_id]", "Identifier": {"ColumnReference": {"@Column": "@current_step_id"}}}}}}}}}}, "ParameterList": {"ColumnReference": {"@Column": "@current_step_id", "@ParameterDataType": "uniqueidentifier", "@ParameterCompiledValue": "{guid'E7FAB167-C47A-4865-A8AE-429FA778414C'}"}}}}, {"@StatementText": "\r\n\r\n\r\nselect @next_step_order=min(step_order)\r\nfrom t_test_step\r\nwhere t_test_id=@t_test_id and step_order>@step_order", "@StatementId": "3", "@StatementCompId": "4", "@StatementType": "SELECT", "@RetrievedFromCache": "false", "@StatementSubTreeCost": "0.00334737", "@StatementEstRows": "1", "@SecurityPolicyApplied": "false", "@StatementOptmLevel": "FULL", "@QueryHash": "0x968373566945F896", "@QueryPlanHash": "0xBF2C9D014AB2050D", "@StatementOptmEarlyAbortReason": "GoodEnoughPlanFound", "@CardinalityEstimationModelVersion": "70", "StatementSetOptions": {"@QUOTED_IDENTIFIER": "true", "@ARITHABORT": "true", "@CONCAT_NULL_YIELDS_NULL": "true", "@ANSI_NULLS": "true", "@ANSI_PADDING": "true", "@ANSI_WARNINGS": "true", "@NUMERIC_ROUNDABORT": "false"}, "QueryPlan": {"@CachedPlanSize": "24", "@CompileTime": "3", "@CompileCPU": "3", "@CompileMemory": "304", "MemoryGrantInfo": {"@SerialRequiredMemory": "0", "@SerialDesiredMemory": "0", "@GrantedMemory": "0", "@MaxUsedMemory": "0"}, "OptimizerHardwareDependentProperties": {"@EstimatedAvailableMemoryGrant": "311472", "@EstimatedPagesCached": "77868", "@EstimatedAvailableDegreeOfParallelism": "2", "@MaxCompileMemory": "853880"}, "RelOp": {"@NodeId": "0", "@PhysicalOp": "Stream Aggregate", "@LogicalOp": "Aggregate", "@EstimateRows": "1", "@EstimateIO": "0", "@EstimateCPU": "1.1e-06", "@AvgRowSize": "11", "@EstimatedTotalSubtreeCost": "0.00334737", "@Parallel": "0", "@EstimateRebinds": "0", "@EstimateRewinds": "0", "@EstimatedExecutionMode": "Row", "OutputList": {"ColumnReference": {"@Column": "Expr1002"}}, "StreamAggregate": {"DefinedValues": {"DefinedValue": {"ColumnReference": {"@Column": "Expr1002"}, "ScalarOperator": {"@ScalarString": "MIN([PSYCHOLOGY_TEST_1].[dbo].[T_TEST_STEP].[STEP_ORDER])", "Aggregate": {"@Distinct": "0", "@AggType": "MIN", "ScalarOperator": {"Identifier": {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}}}}}}}, "RelOp": {"@NodeId": "1", "@PhysicalOp": "Top", "@LogicalOp": "Top", "@EstimateRows": "1", "@EstimateIO": "0", "@EstimateCPU": "1e-07", "@AvgRowSize": "11", "@EstimatedTotalSubtreeCost": "0.00334627", "@Parallel": "0", "@EstimateRebinds": "0", "@EstimateRewinds": "0", "@EstimatedExecutionMode": "Row", "OutputList": {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}}, "Top": {"@RowCount": "0", "@IsPercent": "0", "@WithTies": "0", "TopExpression": {"ScalarOperator": {"@ScalarString": "(1)", "Const": {"@ConstValue": "(1)"}}}, "RelOp": {"@NodeId": "2", "@PhysicalOp": "Index Seek", "@LogicalOp": "Index Seek", "@EstimateRows": "1", "@EstimateRowsWithoutRowGoal": "27.825", "@EstimatedRowsRead": "282", "@EstimateIO": "0.00460648", "@EstimateCPU": "0.0004672", "@AvgRowSize": "27", "@EstimatedTotalSubtreeCost": "0.00334131", "@TableCardinality": "940", "@Parallel": "0", "@EstimateRebinds": "0", "@EstimateRewinds": "0", "@EstimatedExecutionMode": "Row", "OutputList": {"ColumnReference": [{"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}, {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_ID"}]}, "IndexScan": {"@Ordered": "1", "@ScanDirection": "FORWARD", "@ForcedIndex": "0", "@ForceSeek": "0", "@ForceScan": "0", "@NoExpandHint": "0", "@Storage": "RowStore", "DefinedValues": {"DefinedValue": [{"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}}, {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_ID"}}]}, "Object": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Index": "[IX_T_TEST_STEP_1]", "@IndexKind": "NonClustered", "@Storage": "RowStore"}, "SeekPredicates": {"SeekPredicateNew": {"SeekKeys": {"StartRange": {"@ScanType": "GT", "RangeColumns": {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}}, "RangeExpressions": {"ScalarOperator": {"@ScalarString": "[@step_order]", "Identifier": {"ColumnReference": {"@Column": "@step_order"}}}}}}}}, "Predicate": {"ScalarOperator": {"@ScalarString": "[PSYCHOLOGY_TEST_1].[dbo].[T_TEST_STEP].[T_TEST_ID]=[@t_test_id]", "Compare": {"@CompareOp": "EQ", "ScalarOperator": [{"Identifier": {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_ID"}}}, {"Identifier": {"ColumnReference": {"@Column": "@t_test_id"}}}]}}}}}}}}}}}], "StmtCond": {"@StatementText": "\r\n\r\nif (@next_step_order is not null) and (@next_step_order>@step_order)", "@StatementId": "4", "@StatementCompId": "5", "@StatementType": "COND", "@RetrievedFromCache": "false", "Condition": null, "Then": {"Statements": {"StmtSimple": {"@StatementText": "\r\nbegin\r\n  select @next_step_id=t_test_step_id\r\n  from t_test_step\r\n  where t_test_id=@t_test_id and step_order=@next_step_order", "@StatementId": "5", "@StatementCompId": "6", "@StatementType": "SELECT", "@RetrievedFromCache": "false", "@StatementSubTreeCost": "0.0032831", "@StatementEstRows": "1", "@SecurityPolicyApplied": "false", "@StatementOptmLevel": "TRIVIAL", "@QueryHash": "0xB0188EF8F1F36495", "@QueryPlanHash": "0xA4D1017AE79A8837", "@CardinalityEstimationModelVersion": "70", "StatementSetOptions": {"@QUOTED_IDENTIFIER": "true", "@ARITHABORT": "true", "@CONCAT_NULL_YIELDS_NULL": "true", "@ANSI_NULLS": "true", "@ANSI_PADDING": "true", "@ANSI_WARNINGS": "true", "@NUMERIC_ROUNDABORT": "false"}, "QueryPlan": {"@CachedPlanSize": "16", "@CompileTime": "1", "@CompileCPU": "1", "@CompileMemory": "192", "MemoryGrantInfo": {"@SerialRequiredMemory": "0", "@SerialDesiredMemory": "0", "@GrantedMemory": "0", "@MaxUsedMemory": "0"}, "OptimizerHardwareDependentProperties": {"@EstimatedAvailableMemoryGrant": "311472", "@EstimatedPagesCached": "77868", "@EstimatedAvailableDegreeOfParallelism": "2", "@MaxCompileMemory": "853880"}, "RelOp": {"@NodeId": "0", "@PhysicalOp": "Index Seek", "@LogicalOp": "Index Seek", "@EstimateRows": "1", "@EstimatedRowsRead": "1", "@EstimateIO": "0.003125", "@EstimateCPU": "0.0001581", "@AvgRowSize": "23", "@EstimatedTotalSubtreeCost": "0.0032831", "@TableCardinality": "940", "@Parallel": "0", "@EstimateRebinds": "0", "@EstimateRewinds": "0", "@EstimatedExecutionMode": "Row", "OutputList": {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_STEP_ID"}}, "IndexScan": {"@Ordered": "1", "@ScanDirection": "FORWARD", "@ForcedIndex": "0", "@ForceSeek": "0", "@ForceScan": "0", "@NoExpandHint": "0", "@Storage": "RowStore", "DefinedValues": {"DefinedValue": {"ColumnReference": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_STEP_ID"}}}, "Object": {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Index": "[IX_T_TEST_STEP_1]", "@IndexKind": "NonClustered", "@Storage": "RowStore"}, "SeekPredicates": {"SeekPredicateNew": {"SeekKeys": {"Prefix": {"@ScanType": "EQ", "RangeColumns": {"ColumnReference": [{"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "STEP_ORDER"}, {"@Database": "[PSYCHOLOGY_TEST_1]", "@Schema": "[dbo]", "@Table": "[T_TEST_STEP]", "@Column": "T_TEST_ID"}]}, "RangeExpressions": {"ScalarOperator": [{"@ScalarString": "[@next_step_order]", "Identifier": {"ColumnReference": {"@Column": "@next_step_order"}}}, {"@ScalarString": "[@t_test_id]", "Identifier": {"ColumnReference": {"@Column": "@t_test_id"}}}]}}}}}}}, "ParameterList": {"ColumnReference": {"@Column": "@next_step_id", "@ParameterDataType": "uniqueidentifier", "@ParameterCompiledValue": "{guid'E7FAB167-C47A-4865-A8AE-429FA778414C'}"}}}}}}, "Else": {"Statements": {"StmtSimple": {"@StatementText": "\r\n\r\nend\r\nelse \r\nset @next_step_id = null \r\n\r\n", "@StatementId": "6", "@StatementCompId": "9", "@StatementType": "ASSIGN", "@RetrievedFromCache": "false"}}}}}}}}}}}}