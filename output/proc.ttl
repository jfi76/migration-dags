@prefix ns1: <http://www.example.com/MIGRATION#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

ns1:N07c1c3f304974ba4a39d8fbe86d0db8c a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "doback" ;
    ns1:hasProcedure ns1:ac3cd396-a02d-4e87-808e-79e872409a63 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N16a8c829a07545239d4cf2a1e342dde6 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "get_next_step_id" ;
    ns1:hasProcedure ns1:225a8724-30a3-4d85-8240-c2d4dc8cd128 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N1861b1de042845a2955eada7e8076981 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "select_tests" ;
    ns1:hasProcedure ns1:fdc27651-a81c-4985-8526-40cd77b96d6d ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N191ef57092334d9bb67f46a08d5232f7 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "time_remaining" ;
    ns1:hasProcedure ns1:1de21e51-d5ef-4e05-a456-36715c4b8b61 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N26df29245b3f43f88b07d80b73a99a08 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "get_test_introduction" ;
    ns1:hasProcedure ns1:8902f0ef-0677-432e-8bfe-13ec21684848 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N272263580ebf4a7db28416722caac6bf a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "" ;
    ns1:ERROR_MSG """(psycopg2.errors.SyntaxError) ОШИБКА:  "count" - не известная переменная
LINE 10:  into count
               ^

[SQL: 
create or replace procedure dopass 
( perscode VARCHAR  (12) ,  passw VARCHAR  (20) ,  inout t_testing_id UUID )
language plpgsql
as $$

begin
select \r

 into count
from t_workstation w \r
inner join t_testing t on w.t_testing_id = t.t_testing_id \r
inner join t_persona p on t.t_persona_id = p.t_persona_id \r
where w.passw  =passw and perscode =perscode ;
select w.t_testing_id\r
  
 into t_testing_id
from t_workstation w \r
  inner join t_testing t on w.t_testing_id = t.t_testing_id \r
  inner join t_persona p on t.t_persona_id = p.t_persona_id \r
  where w.passw  =passw and perscode =perscode ;
end; $$]
(Background on this error at: https://sqlalche.me/e/14/f405)""" ;
    ns1:hasProcedure ns1:535b2574-d786-4b18-b637-eebbffcda348 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N2a3bbea771904c48ba6c3e0386289b8b a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "get_common_introduction" ;
    ns1:hasProcedure ns1:064adcef-f2bb-40e8-9784-d6169530de73 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N2f0bcce007364dc5937718f21f0004f7 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "ws_type" ;
    ns1:hasProcedure ns1:9efb795e-0cf8-4015-83ed-0d0bc412d768 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N39d46b7d56924961a28a9930a2f52d03 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "selupd_1print" ;
    ns1:hasProcedure ns1:3f293ed7-683c-45d4-9ca9-bcbba4be061e ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N445d2af43bee4d28b8289680df2d7821 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "workstation_clear" ;
    ns1:hasProcedure ns1:10c35936-a600-4ce4-b4ac-b01b09b68e3e ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N4b7cf85a6d11481991583c66c4864aa1 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "get_prev_step_id" ;
    ns1:hasProcedure ns1:0b269f94-2120-4554-9c7a-5d0e6800f13b ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N4e628542c8a14cbb9aca199c04b4cf64 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "stat_change_help2" ;
    ns1:hasProcedure ns1:2e1d845d-07a8-4ac2-89fd-3ed7454dfca1 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N53b24cf7b95b4babbd9b9d54b0d04afb a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "test1" ;
    ns1:hasProcedure ns1:6adf0213-b004-4cce-9bbf-6d25f769578d ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N55cc42558dc841a09c08ee4c86acc405 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "inititate_testing" ;
    ns1:hasProcedure ns1:acbc2aad-7fa1-4e30-833a-51cc862a6413 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N5a844c22c3a04337b1068d22e5b97850 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "get_common_ended" ;
    ns1:hasProcedure ns1:776fcc2a-3715-4f33-8b7b-037610a35bfa ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N6c7cd3be99524c80a0bc57ae211e5a90 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "tmp_insupd_test_step" ;
    ns1:hasProcedure ns1:b157d68d-dc24-45c1-98a2-4b3250d1bd47 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N779ed1eba05244e99ec1f2e056fb0c62 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "" ;
    ns1:ERROR_MSG """(psycopg2.errors.SyntaxError) ОШИБКА:  "update" - не известная переменная
LINE 8: UPDATE [dbo].[T_TEST]
        ^

[SQL: 
create or replace procedure temp_insupd_test 
( t_test_id UUID )
language plpgsql
as $$

begin
UPDATE [dbo].[T_TEST]\r
	   SET [OBJ_NAME] = t2.OBJ_NAME,\r
		  [TIMELIMITMIN] = t2.TIMELIMITMIN,\r
		  [ORDER_NUM] = t2.ORDER_NUM,\r
		  [ACTUAL_MARK] = t2.ACTUAL_MARK,\r
		  [T_TEST_ID] = t2.T_TEST_ID,\r
		  [NOTES_LANG1] = t2.NOTES_LANG1,\r
		  [PAGE_USR_TEXT_LANG1] = t2.PAGE_USR_TEXT_LANG1,\r
		  [PAGE_USR_TEXT_LANG2] = t2.PAGE_USR_TEXT_LANG2,\r
		  [PAGE_USR_TEXT_LANG3] = t2.PAGE_USR_TEXT_LANG3,\r
		  [NOTES_LANG2] = t2.NOTES_LANG2, \r
		  [NOTES_LANG3] = t2.NOTES_LANG3, \r
		  [BACK_BTN_MARK] = t2.BACK_BTN_MARK,\r
		  [USER_QUESTION_MARK] = t2.USER_QUESTION_MARK,\r
		  [BACK_ONLY_1_STEP] = t2.BACK_ONLY_1_STEP,\r
		  [STOP_TIMES] = t2.STOP_TIMES, \r
		  [SHOW_QUESTION_MARK] = t2.SHOW_QUESTION_MARK\r
	from T_TEST t1\r
	inner join tmp_t_test t2 on t1.t_test_id = t2.t_test_id\r
	WHERE t2.t_test_id  =t_test_id ;
end; $$]
(Background on this error at: https://sqlalche.me/e/14/f405)""" ;
    ns1:hasProcedure ns1:46f740f7-9d4d-480e-ae58-1e5750fcedbd ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N81f44689677c406183a3a00df89f2f4a a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "temp_insupd_test" ;
    ns1:hasProcedure ns1:46f740f7-9d4d-480e-ae58-1e5750fcedbd ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N89f43228a8d84e6996725c6baea4cbdf a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "dopass" ;
    ns1:hasProcedure ns1:535b2574-d786-4b18-b637-eebbffcda348 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N9157cf49dbc447cb90eba48e525ad554 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "" ;
    ns1:ERROR_MSG """(psycopg2.errors.SyntaxError) ОШИБКА:  ошибка синтаксиса (примерное положение: "from")
LINE 101: from t_test_step ts left outer join 
          ^

[SQL: 
create or replace procedure testing_status 
( t_testing_id UUID )
language plpgsql
as $$
declare 
last_step_id UUID ; 
t_workstation_id UUID ; 
stop_time_sec int ; 
back_btn_mark CHAR (1); 
lang_num int ; 
step int ; 
test_num int ; 
firstname VARCHAR (100); 
show_question_mark CHAR (1); 
time_limit_min int ; 
question_btn_mark CHAR (1); 
count_stop_times int ; 
current_step_id UUID ; 
seconds_remain int ; 
step_count int ; 
lang_short_code VARCHAR (3); 
secondname VARCHAR (100); 
t_test_id UUID ; 
stop_times int ; 
step_num VARCHAR (100); 
CURRENT_STOP_TIME TIMESTAMP(3) ; 
perscode CHAR (12); 
jsfile VARCHAR (50); 
status VARCHAR (10); 
test_name VARCHAR (100); 

begin
select t.t_workstation_id,\r
ts.obj_name  \r

 into t_workstation_id,status
from t_testing t\r
inner join t_testing_status ts \r
on t.t_testing_status_id = ts.t_testing_status_id \r
where t_testing_id =t_testing_id ;
select obj_name 
 into status
from t_testing_status ts\r
 inner join t_testing t on ts.t_testing_status_id = t.t_testing_status_id\r
 where  t.t_testing_id  =t_testing_id ;
select tl.lang_num,\r
tl.lang_short_code\r

 into lang_num,lang_short_code
from t_testing t \r
inner join t_testing_language tl \r
on t.t_testing_language_id = tl.t_testing_language_id \r
where t.t_testing_id =t_testing_id ;
select \r
firstname,\r
secondname,\r
perscode\r

 into firstname,secondname,perscode
from t_persona p \r
inner join t_testing t on p.t_persona_id = t.t_persona_id\r
where t.t_testing_id =t_testing_id ;
select t_test_id,obj_name,order_num\r
  \r
  
 into t_test_id,test_name,test_num
from   t_test\r
  where order_num =\r
  (\r
  select min(order_num) \r
  from t_testing_test tt inner join t_test te\r
  on tt.t_test_id= te.t_test_id\r
  where tt.t_testing_test_status_id = 4\r
  and tt.t_testing_id  =t_testing_id );
select obj_name,order_num  \r
  
 into test_name,test_num
from t_test \r
  where t_test_id =t_test_id ;
select   \r
  
 into step_count
from t_test_step \r
  where t_test_id =t_test_id ;
select current_test_id \r
  
 into t_test_id
from t_testing \r
  where t_testing_id  =t_testing_id ;
select  current_step_id\r
  
 into current_step_id
from t_testing_test \r
  where  t_testing_id  =t_testing_id and \r
  t_test_id  =t_test_id ;
select ts.step_num,ts.step_order,\r
	 \r
  
 into step_num,step,jsfile
from t_test_step ts left outer join \r
  t_test_step_js_file js on      \r
	ts.t_test_step_js_file_id=js.t_test_step_js_file_id\r
  where ts.t_test_step_id =current_step_id ;
select te.obj_name,te.order_num,\r
  te.user_question_mark,\r
  te.back_btn_mark,\r
  CURRENT_STOP_TIME,\r
  stop_time_sec,\r
  tt.count_stop_times,\r
  te.stop_times,\r
  te.timelimitmin,\r
  te.show_question_mark\r
  
 into test_name,test_num,question_btn_mark,back_btn_mark,CURRENT_STOP_TIME,stop_time_sec,count_stop_times,stop_times,time_limit_min,show_question_mark
from t_test te inner join t_testing_test tt\r
  on te.t_test_id=tt.t_test_id \r
  where te.t_test_id =t_test_id and tt.t_testing_id =t_testing_id ;
select   \r
  
 into step_count
from t_test_step \r
  where t_test_id =t_test_id ;
end; $$]
(Background on this error at: https://sqlalche.me/e/14/f405)""" ;
    ns1:hasProcedure ns1:288bb340-97de-405a-a132-b30e8d74d5c9 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:N958cb8ac091341df81647f5377985e79 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "" ;
    ns1:ERROR_MSG """(psycopg2.errors.SyntaxError) ОШИБКА:  ошибка синтаксиса (примерное положение: "from")
LINE 21: from t_workstation 
         ^

[SQL: 
create or replace procedure ws_type 
( ip_address VARCHAR  (100) ,  inout ip_auth CHAR  (1) ,  inout t_workstation_id UUID ,  inout t_testing_id UUID ,  t_ws_status_id_active UUID )
language plpgsql
as $$
declare 
ws_ip_count int ; 

begin
select \r

 into ws_ip_count
from t_workstation \r
where ip_address =ip_address and \r
t_workstation_status_id =t_ws_status_id_active and auth_type=0;
select \r
   t_workstation_id\r
   ,t_testing_id,\r
   
 into t_workstation_id,t_testing_id,ip_auth
from t_workstation \r
   where ip_address =ip_address ;
end; $$]
(Background on this error at: https://sqlalche.me/e/14/f405)""" ;
    ns1:hasProcedure ns1:9efb795e-0cf8-4015-83ed-0d0bc412d768 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nb0a256dd982f44b09168187ae669a86e a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "inititate_testing2" ;
    ns1:hasProcedure ns1:ae5ab336-b714-40db-8627-e4714170d615 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nb13b33e36042462b9b95247899d38cc5 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "stat_change_instruct" ;
    ns1:hasProcedure ns1:30dbe4da-2c29-4689-8d33-16997173c504 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nb8f0c372ce7c4a1e84e5758e985e014c a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "get_test_step" ;
    ns1:hasProcedure ns1:235012f4-1132-4d4e-9a54-3f2efeddbea4 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nb9d0e2542e2d4ae987ad829c5597b45f a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "" ;
    ns1:ERROR_MSG """(psycopg2.errors.SyntaxError) ОШИБКА:  ошибка синтаксиса (примерное положение: "1")
LINE 11: select  top 1  t.t_testing_id 
                     ^

[SQL: 
create or replace procedure selupd_1print 
()
language plpgsql
as $$
declare 
t_testing_id UUID ; 
job_count int ; 

begin
select  top 1  t.t_testing_id \r

 into t_testing_id
from t_testing t \r
inner join t_testing_status ts \r
on t.t_testing_status_id = ts.t_testing_status_id\r
where ts.obj_name='ENDED'\r
and datepart(day,t.obj_created)=datepart(day,getdate())\r
and datepart(month,t.obj_created)=datepart(month,getdate())\r
and datepart(year,t.obj_created)=datepart(year,getdate())\r
and t.print_count=0 \r
order by t.obj_created \r
;
select  count(t.t_testing_id) \r

 into job_count
from t_testing t \r
inner join t_testing_status ts \r
on t.t_testing_status_id = ts.t_testing_status_id\r
where ts.obj_name='ENDED'\r
and datepart(day,t.obj_created)=datepart(day,getdate())\r
and datepart(month,t.obj_created)=datepart(month,getdate())\r
and datepart(year,t.obj_created)=datepart(year,getdate())\r
and t.print_count=0 \r
;
end; $$]
(Background on this error at: https://sqlalche.me/e/14/f405)""" ;
    ns1:hasProcedure ns1:3f293ed7-683c-45d4-9ca9-bcbba4be061e ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nc20547e0e3a64ff0abf9a1364aa1733c a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "" ;
    ns1:ERROR_MSG """(psycopg2.errors.SyntaxError) ОШИБКА:  "update" - не известная переменная
LINE 8: UPDATE [dbo].[T_TEST_STEP]
        ^

[SQL: 
create or replace procedure tmp_insupd_test_step 
( t_test_id UUID )
language plpgsql
as $$

begin
UPDATE [dbo].[T_TEST_STEP]\r
   SET [STEP_NUM] = t2.STEP_NUM,\r
      [STEP_ORDER] = t2.STEP_ORDER,\r
      [PAGE_USR_TEXT_LANG1] = t2.PAGE_USR_TEXT_LANG1,\r
      [PAGE_USR_TEXT_LANG2] = t2.PAGE_USR_TEXT_LANG2,\r
      [PAGE_USR_TEXT_LANG3] = t2.PAGE_USR_TEXT_LANG3,\r
\r
      [T_TEST_STEP_JS_FILE_ID] = t2.T_TEST_STEP_JS_FILE_ID,\r
      [ACTUAL_MARK] = t2.ACTUAL_MARK\r
 from t_test_step t1 \r
 inner join tmp_t_test_step t2 on t1.t_test_step_id = t2.t_test_step_id \r
 WHERE t2.t_test_id  =t_test_id ;
end; $$]
(Background on this error at: https://sqlalche.me/e/14/f405)""" ;
    ns1:hasProcedure ns1:b157d68d-dc24-45c1-98a2-4b3250d1bd47 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nc8ce55513f054e078c5c82156bc270e2 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "stat_change_help" ;
    ns1:hasProcedure ns1:8248c3ee-d8f4-401b-ac81-1ff0d8ddb8bd ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nd3f4e052dfc646a18548a2ad9f0d4e8f a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "workstation_status" ;
    ns1:hasProcedure ns1:a1b1c98d-668a-4ea0-addb-f23503716acb ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nd6cc07e7bb0f4d13b9d8ccdec49f37a0 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "stat_change_testing" ;
    ns1:hasProcedure ns1:0f09f58b-19ba-42eb-b250-f85dcb19ea5f ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nd720c57541f142e9966eb2b5700437bc a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "" ;
    ns1:ERROR_MSG """(psycopg2.errors.SyntaxError) ОШИБКА:  ошибка синтаксиса (примерное положение: ",")
LINE 18: ,
         ^

[SQL: 
create or replace procedure time_remaining 
( t_testing_id UUID ,  t_test_id UUID )
language plpgsql
as $$
declare 
STOP_TIME_SEC int ; 
timelimitmin int ; 
start_time TIMESTAMP(3) ; 

begin
select \r

 into timelimitmin
from t_test \r
where t_test_id =t_test_id ;
select  \r
,\r

 into start_time,STOP_TIME_SEC
from t_testing_step ts\r
inner join t_test_step s on ts.t_test_step_id=s.t_test_step_id\r
inner join t_testing_test tt on s.t_test_id=tt.t_test_id \r
where s.t_test_id =t_test_id and ts.t_testing_id =t_testing_id and tt.t_testing_id =t_testing_id ;
end; $$]
(Background on this error at: https://sqlalche.me/e/14/f405)""" ;
    ns1:hasProcedure ns1:1de21e51-d5ef-4e05-a456-36715c4b8b61 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nd9bb28459e4f4791ad146812fac7b241 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "insupd_score" ;
    ns1:hasProcedure ns1:e0b5d629-3ee3-4008-a7da-b68a4e431255 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nde278523b64d4d59970dc0162cf19ebd a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "stat_change_prepared" ;
    ns1:hasProcedure ns1:9e12188a-8808-4498-8c33-57bc708dbea1 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Ne668b2864263427b8c6b89049fbe8300 a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "testing_status" ;
    ns1:hasProcedure ns1:288bb340-97de-405a-a132-b30e8d74d5c9 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

ns1:Nfbbc745fe9bd4370ba57c4d91d813f6e a ns1:runcreateprocessprocedure,
        owl:NamedIndividual ;
    rdfs:label "donext" ;
    ns1:hasProcedure ns1:4ef71d22-c59e-4ff3-a8a1-a24fd6bf19e0 ;
    ns1:hasTask ns1:Ncb42efca673e4aceab0e7b908154b21b .

